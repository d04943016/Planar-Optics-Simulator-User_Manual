# 03. Device Structure

---

**Author: Wei-Kai Lee (PhD, National Taiwan University (NTU), Taiwan)**<br/>**Built From: 2013-2021**<br/>**email: d04943016@ntu.edu.tw**<br/>

**Manual Script Date: 2021/03/17**<br/>

***If there is any bug, please inform the authors.***

---

## Objective

---

### Planar Structure

In this simulation software, most of the simulation modules are based on the planar structure. As a result, the user should load a planar structure file. 

### Coherent Layers and Incoherent Layers

Besides the electromagnetic (EM) wave optics, we also deal with the geometric/ray optics in some simulation modules. As a result, the optics properties should be calculated by the EM wave optics in a coherent layer; in contrast, the optics properties should be calculated by the ray optics in an incoherent layer.

### Incoherent Sets

As **FIG. A(b)**, the most general planar structure is consisted of several continuous coherent layers and incoherent layers, i.e. an coherent and incoherent alternating layers. We define a coherent set is a continuous coherent layers. Between each coherent set there is one incoherent layer. Or between two adjacent incoherent layers, there is a coherent set. 

---

Note: In this software, we do not define what is an incoherent set. Besides, because the interface between two adjacent incoherent layer should be calculated by the EM wave optics (Fresnel Equations), the interface also belongs to a coherent set.

---

<p align="center">
<img src="./Picture/03. Device Structure/Fig. A. Planar Structure Schematic.png" width="800">
</p><center><strong>FIG. A. Schematic of Planar Structure</strong></center>

### A. Structure File

Structure file is an important file that should be generated by the user manually. Structure file is used to define the device structure for simulation.  Structure file is just a simple text file and there are some sample structure in **./src/Execution/Example/strucuture**. 

There are three different parts in a structure file as shown in **Fig. B.**. 

First, define the material order and the corresponding thickness (necessary). <br/>Second, the emitting wavelength (optional). <br/>Third, the properties of emission layer (optional).  

<p align="center">
<img src="./Picture/03. Device Structure/Fig. B. Structure file.png" width="800">
</p><center><strong>FIG. B. Structure File</strong></center>

#### Part I. Material Order & Thickness

As shown in **FIG. B.**, there are three parts in **Part I**, including material name (MATERIAL), thickness (THICKNESS(nm)), and file directory path (NKPATH, optional). 

##### (a) MATERIAL

The layer number is defined from top to down (i.e. Layer 1, Layer 2, ..., Layer 9 in **FIG. B.**) and +z is toward from down to top. Material name should match the material name/alias in the nk database, or the file name is default material nk directory, or the directory path specified in "NKPATH". 

##### (b) NKPATH (Optional)

NKPath is to specify the material directory if there is no material named in "MATERIAL". If the material name has been defined in the nk database, NKPATH is useless. 

##### (c) THICKNESS(nm)

Thickness should unit in nm. There are four different possible expressions. 

> <br/>1. A single value. For example, 50.<br/>2. X1:X2:X3, scan the value of thickness. X1:X2:X3 is a [arithmetic sequence](https://en.wikipedia.org/wiki/Arithmetic_progression). X1 is the start value, X3 is the end value, and X2 is the common difference. It should be notice that there is no white spacing between each number. For example, 5:5:120.<br/>3. (X1,X2,X3,..,XN), multiple values of thickness. There are many numbers between the parentheses and the numbers are separated by ','. It should be notice that there is no white spacing between each number. For example, (5,7,10.5,20).<br/>4. X, big X. X specifies an incoherent material/layer. The layers between adjacent two layers with X are defined as a coherent set.

#### Part II. Emission Wavelength (Optional)

This part defines the emission wavelength (nm). It should be notice that this part is only related to the internal emission. It is **not** the wavelength of external light. Depending on the different commands, the simulated spectrum would be integrated or not. There are three different possible expressions.  

> <br>1. A single value. For example, 520.<br/>2. X1:X2:X3, scan the value of wavelength. X1:X2:X3 is a [arithmetic sequence](https://en.wikipedia.org/wiki/Arithmetic_progression). X1 is the start value, X3 is the end value, and X2 is the common difference. It should be notice that there is no white spacing between each number. For example, 500:10:520.<br/>3. (X1,X2,X3,..,XN), multiple values of wavelength. There are many numbers between the parentheses and the numbers are separated by **,**. It should be notice that there is no white spacing between each number. For example, (500,510.530).<br/>

#### Part III. Emitting Properties (Optional)

This part specifies the emitting properties of the emitters and there are 8 different tags. 

##### (a) Layerno

the layer number of emitting layer (EML). <br/>If there are more than one emitting layer or emitter, use **,** to separate the layer number. It should be notice that there should not be any  space. For example, 5,5,6.

##### (b) Position(nm)

The emitting distance between the emitters and the interface of EML and the layer below EML. There are three different possible expressions.  If there are more than one emitting layer or emitter, use **,** to separate the position. It should be notice that there should not be any  space. For example, 10,10,10.

>  <br>1. A single number. For example, 50.<br/>2. X1:X2:X3, scan the value of position. X1:X2:X3 is a [arithmetic sequence](https://en.wikipedia.org/wiki/Arithmetic_progression). X1 is the start value, X3 is the end value, and X2 is the common difference. It should be notice that there is no white spacing between each number. For example, 0:1:10.<br/>3. (X1,X2,X3,..,XN), multiple values of position. There are many numbers between the parentheses and the numbers are separated by **,**. It should be notice that there is no white spacing between each number. For example, (1,5,7).<br/>

##### (c) ratio 

The ratio between each emitter.  If there are more than one emitting layer or emitter, use **,** to separate the ratios It should be notice that there should not be any space. For example, 0.5,0.2,0.3.

>  <br>1. A single number. For example, 1.0.<br/>2. X1:X2:X3, scan the value of position. X1:X2:X3 is a [arithmetic sequence](https://en.wikipedia.org/wiki/Arithmetic_progression). X1 is the start value, X3 is the end value, and X2 is the common difference. It should be notice that there is no white spacing between each number. For example, 0.1:0.1:0.5.<br/>3. (X1,X2,X3,..,XN), multiple values of position. There are many numbers between the parentheses and the numbers are separated by **,**. It should be notice that there is no white spacing between each number. For example, (0.1,0.2,0.4).<br/>

##### (d) QY

The photoluminescence quantum yield (PLQY). If there are more than one emitting layer or emitter, use **,** to separate the QYs. It should be notice that there should not be any space. For example, 1.0,1.0,1.0.

>  <br>1. A singe value. For example, 1.0.<br/>2. X1:X2:X3, scan the value of position. X1:X2:X3 is a [arithmetic sequence](https://en.wikipedia.org/wiki/Arithmetic_progression). X1 is the start value, X3 is the end value, and X2 is the common difference. It should be notice that there is no white spacing between each number. For example, 0.1:0.1:0.5.<br/>3. (X1,X2,X3,..,XN), multiple values of position. There are many numbers between the parentheses and the numbers are separated by **,**. It should be notice that there is no white spacing between each number. For example, (0.1,0.2,0.4).<br/>

##### (e) Fluorescence or FLUO (Optional)

(1)  the name of the emitting spectrum that stored in the PL database, (2) PL file name with directory specifying by FLUOPATH, or (3) PL file with default material PL directory if FLUOPATH is not specified.  If there are more than one emitting layer or emitter, use **,** to separate the FLUO. 

Or if FLUO is not specified, the emission spectrum is determined by the name of EML (Layerno and MATERIAL). 

##### (f) FLUORESNCENCEPATH or FLUOPATH (Optional)

The file path of emitting spectrum. If FLUORESNCENCEPATH is not specified, the default material PL directory is used. If there are more than one emitting layer or emitter, use **,** to separate the FLUOPATH. 

##### (g) DOF (Optional)

(1)  the name of the dipole orientation factor that stored in the DOF database, (2) DOF file name with directory specifying by DOFPATH, or (3) DOF file with default material DOF directory if DOFPATH is not specified.  If there are more than one emitting layer or emitter, use **,**  to separate the DOF. 

Or if DOF is not specified, the dipole orientation factor is determined by the name of EML (Layerno and MATERIAL). 

##### (h) DOFPATH (Optional)

The file path of dipole orientation factor If DOFPATH is not specified, the default material DOF directory is used. If there are more than one emitting layer or emitter, use **,** to separate the DOFPATH. 

##### Tips

Basically, if there is a single emitter in one layer, the user can just use the name of the EML in Part I without specifying FLUO and DOF. In this situation, the name of material should be the same as the name of emitting spectrum and dipole orientation factors no matter in the database or the default directories. However, if it is a host-guest/dopant system and the user would like to use the nk data of the host material in MATERIAL in part I and use emitting spectrum of guest/dopant in part II, the user should explicitly specify the name of FLUO and DOF. Furthermore, if there is more one dopant in a one layer, the user must explicitly specify the name of FLUO and DOF.

### B. Structure List File

In order to schedule the simulation, the user can use the structure list file as shown in **FIG. C.** There 7 different columns in the structure list file. The user can randomly change the order of these columns if the first tag row is specified or the order of the column cannot be randomly changed.

##### (a) Name (Optional)

the name of the device in the software. It should be noticed that only the latest device would remain when simulation and the other device would be discarded. 

##### (b) readfilename

the file name of the device structure

##### (c) readfilepath

the directory of the device file

##### (d) savefilepath

the save file directory

##### (e) savefilename

the save file name

 ##### (f) check

X indicate that the device has not been simulated yet. V indicated that the device has been simulated and as a result, the software would skip this device when simulation.

##### (g) CID (Optional)

Command ID. It is **useless** here.

<p align="center">
<img src="./Picture/03. Device Structure/Fig. C. Stucture list.png" width="1000">
</p><center><strong>FIG. C. Structure List File</strong></center>

## Function 

---

**FIG. D.** shows the structure panel without loading any structure file and **FIG. E.** shows the structure panel with a structure file. There are three different information panel for a structure file, including file information, structure (nk), and emitter (as the same in structure file).

#### file information 

- structure file path 
- structure file name
- data save path
- data save name [please do not use special character in the file name because some special characters are forbidden]

#### structure (nk)

- material order
- thickness
- NKPATH

#### emitter

- Layerno
- Emitting Layer Name
- Position(nm)
- QY
- ratio
- FLUO
- FLUOPATH
- DOF
- DOFPATH
- Emitting Wavelength

<p align="center">
<img src="./Picture/03. Device Structure/Fig. D. Structure Panel.png" width="900">
</p><center><strong>FIG. D. Structure Panel Without Loading Structure File</strong></center>

<p align="center">
<img src="./Picture/03. Device Structure/Fig. E. Structure Panel with structure file.png" width="900">
</p><center><strong>FIG. E. Structure Panel With Structure File</strong></center>

### A. Structure - Load

Load a structure file.

### B. Structure - Delete

Delete a structure file.

### C. Structure - Print

Print a structure on terminal. 

<p align="center">
<img src="./Picture/03. Device Structure/Fig. F. Print Structure File.png" width="800">
</p><center><strong>FIG. F. Print A Structure File on Terminal</strong></center>

### D. Structure - Save

Save a structure file.

### E. Structure List - Load

Load a structure list file.

### F. Structure List - Save

Save a structure list file.

### G. Structure List -Print

Print a structure list file.

<p align="center">
<img src="./Picture/03. Device Structure/Fig. G. Print Structure List File.png" width="1000">
</p><center><strong>FIG. G. Print A Structure List File on Terminal</strong></center>

### H. Save Data, Data Save Path, and Data Save Name

The user can change the save data path and save data name by clicking "Save Data" button or directly change the texts.

#### J. run this device (checkbox)

Whether the file will going to simulate or not.

---

**For better viewing experience, please use Typora for tutorial reading.**











